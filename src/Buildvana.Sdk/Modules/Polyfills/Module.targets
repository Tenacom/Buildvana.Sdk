<Project>

  <!-- Coalesce UsePolyfills to a boolean value, defaulting to true; force to false for non-C# projects. -->
  <PropertyGroup>
    <UsePolyfills Condition="'$(MSBuildProjectExtension)' != '.csproj'">false</UsePolyfills>
    <UsePolyfills Condition="'$(UsePolyfills)' != 'false'">true</UsePolyfills>
  </PropertyGroup>

  <!-- Coalesce UseValidatedNotNullAttribute to a boolean value, defaulting to true; force to false if UsePolyfills is false. -->
  <PropertyGroup>
    <UseValidatedNotNullAttribute> Condition="'$(UsePolyfills)' != 'true'">false</UseValidatedNotNullAttribute>
    <UseValidatedNotNullAttribute Condition="'$(UseValidatedNotNullAttribute)' != 'false'">true</UseValidatedNotNullAttribute>
  </PropertyGroup>

  <!-- Add annotations-related package references where appropriate. -->
  <ItemGroup Condition="$(UsePolyfills)">
    <BV_PackageReference Include="IndexRange" PrivateAssets="All" />
    <BV_PackageReference Include="Nullable" PrivateAssets="All" />
  </ItemGroup>

  <!-- Add annotations-related package references where appropriate. -->
  <ItemGroup Condition="$(UsePolyfills)">
    <Compile Include="$(MSBuildThisFileDirectory)Runtime\*.cs" Visible="false" />
    <Compile Condition="$(UseValidatedNotNullAttribute)" Include="$(MSBuildThisFileDirectory)ValidatedNotNull\*.cs" Visible="false" />
  </ItemGroup>

</Project>
